---
layout: spectre
title: About Spectre
permalink: /spectre/about/
---

## Background

---

As the size and complexity of high-dimensional cytometry data continues to expand, comprehensive analysis tools that can scale to large datasets are required. In our early mass cytometry work, the analysis of high-dimensional datasets using manual methods became prohibitive, requiring the use of computational analysis approaches, such as clustering and dimensionality reduction. However, the analysis tools available at the time were not well suited to the analysis of large cytometry datasets, consistings of tens to hundreds of millions of single cells. Furthermore, popular clustering and dimensionality reduction tools alone are insufficient for scalable or reproducible integration of data across batches, experiments, or different cytometry/single-cell technologies. To address these limitations, we initially developed the ‘Cytometry Analysis Pipeline for large and compleX datasets’ ([CAPX](https://github.com/sydneycytometry/CAPX), the initial version of Spectre), an analysis workflow using the R programming language ([Ashhurst et al. 2019](https://link.springer.com/protocol/10.1007/978-1-4939-9454-0_12)), and derivative stand-alone scripts (e.g. '[tSNEplots](https://github.com/sydneycytometry/tSNEplots)'). Following a seed funding grant from the [Marie Bashir Institute for Infectious Diseases and Biosecurity](https://www.sydney.edu.au/marie-bashir-institute/), we established the ‘[Immune Dynamics](https://immunedynamics.io/team)’ team, a collaborative multi-disciplinary group with a focus on the development of novel computational analysis tools to address challenges in high-dimensional analysis, with a particular focus on the analysis of large datasets, and the incorporation of data integration strategies. We solidified the functionality of the [CAPX](https://github.com/sydneycytometry/CAPX) functionality into a package and re-named it '[Spectre](https://immunedynamics.io/spectre/)' ([Ashhurst\*, Marsh-Wakefield\*, Putri\* et al. bioRxiv. 2020](https://www.biorxiv.org/content/10.1101/2020.10.22.349563v1.abstract)).

<br />

## What is Spectre

---

Spectre is an R package designed to facilitate data analysis workflows that simplify and streamline data manipulation and annotation, population identification (clustering, classification), and dimensionality reduction (t-SNE, UMAP) etc in high-dimensional cytometry data. Strategic implementation of batch-alignment, data-integration, and cell-type classification tools allow for the integrated analysis of multiple experiments, as well as a reproducible system for rapid and repeated cell type identification in large datasets. Critically, the fundamental data structures used within Spectre, along with the implementation of classifiers allow for the scalable analysis of very large high-dimensional datasets. In addition to high-dimensional cytometry datasets, we’ve also developed functions to allow for spatial analysis of high-dimensional imaging datasets, such as those generated by Imaging Mass Cytometry. The simple, clear, and modular design of analysis workflows allow for these tools to be used by informaticians and laboratory scientists alike. Along with the various R packages used within Spectre, some key packages such as the cytofkit and Seurat R packages provided inspiration for elements of the package design.

[Our team](https://immunedynamics.io/team) develops other computational approaches, including tools for the analysis of time-series data (e.g. [ChronoClust](https://github.com/ghar1821/Chronoclust), [Putri et al 2019](https://www.sciencedirect.com/science/article/pii/S0950705119300796); and [TrackSOM](https://github.com/ghar1821/TrackSOM), [Koutsakos et al 2020](https://www.cell.com/cell-reports-medicine/fulltext/S2666-3791(21)00019-7)) or spatial data (e.g. [SpectreMAP](https://immunedynamics.io/spectre/spatial/)). As our tools reach a stable level of development, we incorporate these into Spectre, so they may form part of a cohesive workflow.

<br />

## Works citing Spectre

---

Spectre ([Ashhurst et al, 2020](https://www.biorxiv.org/content/10.1101/2020.10.22.349563v1.abstract)) (or '[CAPX](https://github.com/sydneycytometry/CAPX)', the initial version of Spectre, and associated scripts ([Ashhurst et al 2019](https://link.springer.com/protocol/10.1007/978-1-4939-9454-0_12))) have been used in a wide variety of studies, including the study of COVID-19, vaccine responses, NK cell biology, multiple myeloma, pediatric burns, multiple sclerosis, bone marrow transplantation, and cerebral malaria, among others.

- Koutsakos et al 2021, [Cell Reports Medicine](https://www.sciencedirect.com/science/article/pii/S2666379121000197)
- Ferrell et al 2021, [Mucosal Immunology](https://www.nature.com/articles/s41385-021-00379-6)
- **Ng et al 2020, [Nature Immunology](https://www.researchgate.net/publication/343838774_The_NK_cell_granule_protein_NKG7_regulates_cytotoxic_granule_exocytosis_and_inflammation)**
- Vuckovic et al 2020, [Blood Advances](https://ashpublications.org/bloodadvances/article/4/19/4593/463891/Inverse-relationship-between-oligoclonal-expanded)
- Johnson et al 2020, [Frontiers in Immunology](https://www.frontiersin.org/articles/10.3389/fimmu.2020.01481/full)
- Ferrer-Font et al, 2020, [Cytometry Part A](https://onlinelibrary.wiley.com/doi/abs/10.1002/cyto.a.24016)
- Marsh-Wakefield et al 2020, [Clinical and Translational Immunology](https://onlinelibrary.wiley.com/doi/full/10.1002/cti2.1133)
- Pirozyan 2020, [Fronteirs in Immunology]()
- Counoupas et al 2020, [BioRxiv]()
- Shinko et al 2019, [Frontiers in Immunology]()
- Hayashida et al 2019, [J Neuroinflam]()
- Marsh-Wakefield et al 2019, [Frontiers in immunology]()
- Stifter et al 2019, [Cell Reports]()
- Stern et al 2018, [Frontiers in Immunology]()
- McGuire et al 2018, [Cancer Immunology]()
- Campbell et al 2018, [Plos Pathogens]()
- Jung et al 2018, [J Immunol]()
- **Roediger et al 2018, [Cell](https://doi.org/10.1016/j.cell.2018.08.013)**
- Niewold et al 2018, [Communications in Biology]()

Spectre ([Ashhurst et al, 2020](https://www.biorxiv.org/content/10.1101/2020.10.22.349563v1.abstract)) (or '[CAPX](https://github.com/sydneycytometry/CAPX)', the initial version of Spectre, and associated scripts ([Ashhurst et al 2019](https://link.springer.com/protocol/10.1007/978-1-4939-9454-0_12))) have been also been reference in a number of online forums and posts.

- [ResearchGate](https://www.researchgate.net/post/What_are_the_best_R_packages_for_flow_cytometric_data_analysis): What are the best R packages for flow cytometric data analysis?
- [CyTOForum](http://cytoforum.stanford.edu/viewtopic.php?f=3&t=2007&p=5229&hilit=spectre#p5229): FlowJo transformation before clustering
- [CyTOForum](http://cytoforum.stanford.edu/viewtopic.php?f=3&t=2303&p=5729&hilit=spectre#p5729): Data representation
- [LinkedIn](https://www.linkedin.com/pulse/clinical-studies-immunotherapy-more-immune-monitoring-amir/): Clinical studies, immunotherapy, and more in the Immune Monitoring Biweekly (Issue 27)

Spectre has also featured prominently in a number of **workshops**, such as the '[high-dimensional analysis homeshow](https://immunedynamics.io/homeshow/)' in 2020, hosted by the Australian Cytometry Society and Australia and New Zealand society for Immunology.

<br />

## What makes Spectre different?

---

TBC

<br />

## Built on data.table

---

Many existing computational tools store data in a custom format, such as the flowFrame or SingleCellExperiment object, that provide excellent field-specific structuring of single-cell data. In Spectre, data management and operations are performed using the data.table format, an extension of R’s base data.frame, provided by the data.table package. This table-like structure organises cells (rows) against cellular features or metadata (columns). This simple data.table structure allows for the high-speed processing, manipulation (subsetting, filtering, etc.), and plotting of large datasets, as well as fast reading/writing of large CSV files.

Rather than storing analysis outputs (clusters, dimensionality reduction values, annotations etc) in separate areas of a custom data format, Spectre simply adds new columns to the existing data.table. The simplicity of this data structure facilitates extremely fast and simple filtering/subsetting by data.table, as every cell (row) contains all of the information relevant for that cell: such as cellular expression, samples/groups, clusters/populations, and dimensionality reduction coordinates.

<br />

## Clustering and dimensionality reduction strategies for large datasets

---

Whilst clustering tools such as FlowSOM scale well to large datasets, dimensionality reduction approaches such as t-SNE and UMAP do not; as they incur lengthy computing time, excessive memory usage, and significant crowding effects that inhibit their utility. Whilst some improvements to runtime (flt-SNE) and plot crowding (opt-SNE) have been made, scalability and plot crowding limitations persist. As dimensionality reduction tools are primarily used to visualise cellular data and clustering results, we plot a subset of the clustered data, which addresses scalability and retains legibility. By using proportional subsampling from each sample, the relative number of cells from each cluster in each sample can be preserved in a smaller dataset, allowing for interpretable analysis via DR. Putative cellular populations amongst the clusters can then be identified, and annotated in both the subsampled DR dataset, as well as the whole clustered dataset. The whole annotated dataset can subsequently be used in downstream quantification and statistical analysis.

<br />

## Details

---

TBC

<br />
