---
title: "Batch alignment of high-dimensional cytometry data using rPCA"
author: "Thomas Ashhurst"
date: "28/05/2023"
output:
  html_document:
    toc: true
    toc_depth: 4
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

---

[<- Back to Spectre home page](https://immunedynamics.io/spectre)

<br />
<br />



## Introduction

---

The presence of strong batch effects in cytometry data can lead to enormous challenges in data analysis. One solution to this is to perform a batch 'alignment' or 'integration'. This involves adjusting the marker expression levels to remove technical differences between batches, while preserving biologically meaningful differences between samples and experimental groups. In our other workflows we make use of the [CytoNorm]() package, using biological reference controls processed with each batch of samples to learn the technical differences between batches, and then remove them. However, in situations where biological reference controls are not available, or where there is a high level of marker expression that is not captured by the reference controls, other methods might be needed.

Here we introduce a workflow for integrating data across complex batches, experiments, or panels, without the use of biological reference controls. To do this, we have adapted the **reciprocal PCA (rPCA)** integration method from [Seurat]() to work on cytometry data. Briefly, 

<br />


## Setting up

---

To get started...
